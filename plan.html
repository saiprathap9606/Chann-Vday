<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Warm-up Game ğŸ³</title>

<style>
* {
  box-sizing: border-box;
  font-family: 'Courier New', monospace;
}

body {
  margin: 0;
  min-height: 100vh;
  background: radial-gradient(circle at top, #3a004d, #0b0014);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
}

.card {
  width: 420px;
  background: #0f0a1f;
  border-radius: 24px;
  padding: 28px;
  box-shadow: 0 0 40px rgba(255, 0, 170, 0.3);
  text-align: center;
}

h1 {
  margin: 0;
  font-size: 26px;
}

.sub {
  opacity: 0.8;
  margin-bottom: 16px;
}

/* GAME AREA */
.lane {
  position: relative;
  margin: 20px auto;
  width: 100%;
  height: 240px;
  background: linear-gradient(#3b2b24, #1f140f);
  border-radius: 16px;
  overflow: hidden;
}

/* STRIKE ZONE */
.strike-zone {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 90px;
  height: 100%;
  background: rgba(255, 255, 255, 0.08);
  box-shadow: inset 0 0 25px rgba(255,255,255,0.3);
}

/* PINS */
.pins {
  position: absolute;
  top: 20px;
  left: 50%;
  transform: translateX(-50%);
  display: grid;
  grid-template-columns: repeat(4, 28px);
  gap: 10px;
}

.pin {
  font-size: 22px;
  transition: transform 0.6s ease, opacity 0.6s ease;
}

.pin.down {
  transform: translateY(30px) rotate(25deg);
  opacity: 0.2;
}

/* BALL */
.ball {
  position: absolute;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 28px;
  transition: left 0.15s linear;
}

/* CONTROLS */
button {
  width: 100%;
  margin-top: 16px;
  padding: 14px;
  border: none;
  border-radius: 14px;
  background: #ff4fa3;
  color: white;
  font-size: 18px;
  cursor: pointer;
}

button:disabled {
  opacity: 0.5;
}

/* SCORE */
.score {
  margin-top: 18px;
  text-align: left;
  font-size: 14px;
}

.message {
  margin-top: 12px;
  font-size: 15px;
}

/* CONFETTI */
.confetti {
  position: fixed;
  inset: 0;
  pointer-events: none;
}
</style>
</head>

<body>

<div class="card">
  <h1>Warm-up game ğŸ³</h1>
  <div class="sub">Three rolls. Chan starts ğŸ˜Œ</div>

  <div class="lane" id="lane">
    <div class="strike-zone"></div>

    <div class="pins" id="pins">
      <!-- Triangle formation -->
      <div class="pin">ğŸ“</div>
      <div class="pin">ğŸ“</div>

      <div class="pin">ğŸ“</div>
      <div class="pin">ğŸ“</div>
      <div class="pin">ğŸ“</div>

      <div class="pin">ğŸ“</div>
      <div class="pin">ğŸ“</div>
      <div class="pin">ğŸ“</div>
      <div class="pin">ğŸ“</div>

      <div class="pin">ğŸ“</div>
    </div>

    <div class="ball" id="ball">âš«</div>
  </div>

  <button id="bowlBtn">BOWL ğŸ³</button>

  <div class="message" id="message"></div>

  <div class="score" id="score">
    <strong>Chanâ€™s Score</strong><br/>
    Round 1: â€“<br/>
    Round 2: â€“<br/>
    Round 3: â€“<br/>
    <strong>Total: 0</strong>
  </div>

  <button id="nextBtn" style="display:none;">Next ğŸ’•</button>
</div>

<canvas class="confetti" id="confetti"></canvas>

<audio id="cheer">
  <source src="https://assets.mixkit.co/sfx/preview/mixkit-crowd-cheer-748.mp3">
</audio>

<script>
let round = 1;
let scores = [];
let aimingX = 0.5;

const lane = document.getElementById("lane");
const ball = document.getElementById("ball");
const pins = document.querySelectorAll(".pin");
const message = document.getElementById("message");
const scoreEl = document.getElementById("score");
const bowlBtn = document.getElementById("bowlBtn");
const cheer = document.getElementById("cheer");
const nextBtn = document.getElementById("nextBtn");

/* MOUSE AIM */
lane.addEventListener("mousemove", e => {
  const rect = lane.getBoundingClientRect();
  aimingX = (e.clientX - rect.left) / rect.width;
  aimingX = Math.max(0.1, Math.min(0.9, aimingX));
  ball.style.left = `${aimingX * 100}%`;
});

/* BOWL */
bowlBtn.onclick = () => {
  bowlBtn.disabled = true;

  const accuracy = Math.abs(aimingX - 0.5);
  let knocked;

  if (accuracy < 0.05) {
    knocked = 10; // STRIKE
  } else if (accuracy < 0.1) {
    knocked = 7;
  } else if (accuracy < 0.18) {
    knocked = 5;
  } else {
    knocked = 2;
  }

  pins.forEach((p, i) => {
    if (i < knocked) p.classList.add("down");
  });

  scores.push(knocked);
  message.innerHTML = knocked === 10
    ? "STRIKE! ğŸ‰ Nice roll ğŸ˜"
    : "Nice roll ğŸ˜";

  if (knocked === 10) {
    cheer.play();
    launchConfetti();
  }

  updateScore();

  if (knocked === 10 || round === 3) {
    nextBtn.style.display = "block";
    bowlBtn.style.display = "none";
  } else {
    round++;
    setTimeout(resetPins, 900);
  }
};

/* RESET PINS */
function resetPins() {
  pins.forEach(p => p.classList.remove("down"));
  bowlBtn.disabled = false;
}

/* SCORE UPDATE */
function updateScore() {
  let total = scores.reduce((a,b) => a+b, 0);
  scoreEl.innerHTML = `
    <strong>Chanâ€™s Score</strong><br/>
    Round 1: ${scores[0] ?? "â€“"}<br/>
    Round 2: ${scores[1] ?? "â€“"}<br/>
    Round 3: ${scores[2] ?? "â€“"}<br/>
    <strong>Total: ${total}</strong>
  `;
}

/* CONFETTI */
function launchConfetti() {
  const c = document.getElementById("confetti");
  const ctx = c.getContext("2d");
  c.width = innerWidth;
  c.height = innerHeight;

  let pieces = Array.from({length:120}, () => ({
    x: Math.random()*c.width,
    y: Math.random()*c.height,
    r: Math.random()*6+4,
    s: Math.random()*3+2
  }));

  let t = 0;
  function draw() {
    ctx.clearRect(0,0,c.width,c.height);
    pieces.forEach(p => {
      ctx.beginPath();
      ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
      ctx.fillStyle = "#ff4fa3";
      ctx.fill();
      p.y += p.s;
    });
    if (t++ < 80) requestAnimationFrame(draw);
  }
  draw();
}

nextBtn.onclick = () => {
  window.location.href = "confirm.html";
};
</script>

</body>
</html>
